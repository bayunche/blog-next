{
  "question": "GitHub OAuth 流程缺失在哪？",
  "analysis": "前端 githubAuthCallbackAPI 向 /oauth/github/callback 发送 POST 请求，但 server/router 目录下没有对应路由文件或路由定义。后端登录逻辑集中在 server/router/home.js 的 /api/login 中，当请求包含 code 参数时会在 server/controllers/user.js 的 githubLogin 分支中处理。与此同时，server/config/index.js 默认的 access_token_url 指向 https://github.com/login/oauth/authorize（授权页），而换取 access token 应使用 https://github.com/login/oauth/access_token。",
  "evidence": [
    {
      "file": "src/features/auth/api/index.ts:134-156",
      "snippet": "export const githubAuthCallbackAPI = (params: GithubCallbackParams): Promise<GithubAuthResponse> => { return request.post('/oauth/github/callback', params) }"
    },
    {
      "file": "server/router",
      "lines": [],
      "snippet": "目录中不存在 oauth 相关路由文件，home.js 只暴露 /api/login。"
    },
    {
      "file": "server/router/home.js:11",
      "snippet": "router.post('/login', login)"
    },
    {
      "file": "server/controllers/user.js:203-246",
      "snippet": "UserController.githubLogin 使用 axios.post(GITHUB.access_token_url, ...) 向 authorize URL 发送请求" 
    },
    {
      "file": "server/config/index.js:26-29",
      "snippet": "access_token_url 默认为 'https://github.com/login/oauth/authorize'" 
    }
  ],
  "conclusion": "必须：1) 在后端新增 /api/oauth/github/callback（或等价接口）复用 githubLogin；2) 修正 access_token_url 默认为 https://github.com/login/oauth/access_token，并确保响应结构与前端 GithubAuthResponse 对齐；3) 前端登录入口需跳转 /login?code=... 或直接调用新的回调地址。"
}
